<h1>Tasks</h1>

<hr>

<% @tasks.each do |task| %>
  <div class='col-xs-12 task-row'>
    <div class='row'>
      <div class='col-xs-12 col-md-6'>
        <%= pie_chart({ "Completed" => task.completed, 'To-do' => task.minutes - task.completed }, colors: ["#71000D", "#BE0016"],
          library: { 
            title: { 
              text: link_to(task.description, edit_task_path(task)),
              style: { 'font-size' => '24px' },
              'useHTML' => true
            },
            tooltip: {
              'valueSuffix' => ' minutes'
            }
          }
        ) %>
      </div>
      <div class='col-xs-12 col-md-6'>
        <p class='lead'>
          To-do: <%= task.minutes - task.completed %> minutes
          <br>
          <%= form_for(task) do |f| %>
          <%= f.label :completed %>
            <%= f.number_field :completed, placeholder: (task.completed.to_s + ' minutes'), max: 1000000000, min: 0 %>
            <%= f.submit 'Update Task', method: :update, class: 'btn btn-default' %>
          <% end %>

        </p>
      </div>
    </div>
    <hr>
  </div>
<% end %>

<%= link_to 'New Task', new_task_path, class: 'btn btn-primary' %>

<script>
  // $('.task-row').append('<hr>');
</script>